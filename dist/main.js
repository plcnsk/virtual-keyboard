(()=>{"use strict";const t=function(){function t(t,e,n,o){void 0===e&&(e="div"),void 0===n&&(n=""),void 0===o&&(o="");var r=document.createElement(e);r.className=n,r.innerHTML=o,t&&t.append(r),this.node=r}return t.prototype.destroy=function(){this.node.remove()},t}();var e,n=(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}),o=function(t){function e(e){return t.call(this,e,"div","keyboard_output")||this}return n(e,t),Object.defineProperty(e.prototype,"content",{set:function(t){this.node.textContent=t},enumerable:!1,configurable:!0}),e}(t),r=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=function(){return i=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},i.apply(this,arguments)},a=function(t){function e(e,n,o){var r=t.call(this,e,"div","keyboard_key")||this;return r.state=o,r.data=n,r.node.textContent=n,r.node.onmousedown=function(){r.down(),document.addEventListener("mouseup",(function(){r.input(),r.up()}),{once:!0})},r.node.onmouseenter=function(){r.node.classList.add("keyboard_key__hover")},r.node.onmouseleave=function(){r.node.classList.remove("keyboard_key__hover")},r}return r(e,t),e.prototype.handleDown=function(){this.input(),this.down()},e.prototype.handleUp=function(){this.up()},e.prototype.input=function(){var t=this.state;t.data=i(i({},t.data),{content:t.data.content+this.data})},e.prototype.down=function(){this.node.classList.add("keyboard_key__down")},e.prototype.up=function(){this.node.classList.remove("keyboard_key__down")},e.prototype.setData=function(t){this.data=t,this.node.textContent=t},e}(t),c=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),y=function(){return y=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},y.apply(this,arguments)},u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.input=function(){var t=this.state;t.data=y(y({},t.data),{langIndex:(t.data.langIndex+1)%t.languages.length})},e}(a),s=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),p=function(){return p=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},p.apply(this,arguments)},f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.input=function(){var t=this.state;t.data=p(p({},t.data),{content:t.data.content.slice(0,-1)})},e}(a),l=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),h=function(){return h=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},h.apply(this,arguments)},K=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.input=function(){var t=this.state;t.data=h(h({},t.data),{caps:!t.data.caps}),t.data.caps?this.node.classList.add("keyboard_key__down"):this.node.classList.remove("keyboard_key__down")},e.prototype.down=function(){},e.prototype.up=function(){},e}(a),g=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),d=function(){return d=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},d.apply(this,arguments)},w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return g(e,t),e.prototype.input=function(){},e.prototype.down=function(){var e=this.state;e.data=d(d({},e.data),{shift:!0}),t.prototype.down.call(this)},e.prototype.up=function(){var e=this.state;e.data=d(d({},e.data),{shift:!1}),t.prototype.up.call(this)},e}(a),_=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),D={Backspace:f,ShiftLeft:w,ShiftRight:w,CapsLock:K,Lang:u},v=function(e){function n(n,o,r){var i=e.call(this,n)||this;return i.keyMap={},o.forEach((function(e){var n=new t(i.node,"div","keyboard_row");e.forEach((function(t){var e=new(D[t]||a)(n.node,t,r);i.keyMap[t]=e}))})),i}return _(n,e),n.prototype.setLanguage=function(t){for(var e in t)this.keyMap[e].setData(t[e])},n.prototype.handleDown=function(t){var e=this.keyMap[t];e&&e.handleDown()},n.prototype.handleUp=function(t){var e=this.keyMap[t];e&&e.handleUp()},n}(t);const b=[["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","КeуT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash"],["CapsLock","KeyA","KeyS","KeyD","KeyF","КeуG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter"],["ShiftLeft","KeyZ","KeyX","KeyC","KeyV","КeуB","KeyN","KeyM","Comma","Period","Slash","ArrowUp","ShiftRight"],["Lang","ControlLeft","AltLeft","Space","AltRight","ControlRight","ArrowLeft","ArrowDown","ArrowRight"]];var O=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),k=function(t){function e(e,n){var r=t.call(this,e)||this;r.langIndex=0;var i=function(t){r.output.content=t.content;var e=n.languages[t.langIndex];t.shift?r.board.setLanguage(e.shift):t.caps?r.board.setLanguage(e.caps):r.board.setLanguage(e.base)};return n.onChange.add(i),r.output=new o(r.node),r.board=new v(r.node,b,n),document.addEventListener("keydown",(function(t){console.log(t.code),r.board.handleDown(t.code)})),document.addEventListener("keyup",(function(t){console.log(t.code),r.board.handleUp(t.code)})),i(n.data),r}return O(e,t),e}(t);const L=function(){function t(){this.listeners=[]}return t.prototype.add=function(t){this.listeners.push(t)},t.prototype.remove=function(t){this.listeners=this.listeners.filter((function(e){return e!==t}))},t.prototype.emit=function(t){this.listeners.forEach((function(e){return e(t)}))},t}();var S=function(){return S=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},S.apply(this,arguments)},A={CapsLock:"⇪",ShiftLeft:"⇧",Enter:"\n",Backspace:"⌫",Tab:"⇥",ShiftRight:"⇧",ControlLeft:"^",AltLeft:"",Space:" ",AltRight:"",ControlRight:"^",ArrowUp:"",ArrowLeft:"",ArrowDown:"",ArrowRight:"",Lang:"fn lang"};const m={base:S(S({},A),{Backquote:"`",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",KeyQ:"q",KeyW:"w",KeyE:"e",KeyR:"r",КeуT:"t",KeyY:"y",KeyU:"u",KeyI:"i",KeyO:"o",KeyP:"p",BracketLeft:"[",BracketRight:"]",Backslash:"\\",KeyA:"a",KeyS:"s",KeyD:"d",KeyF:"f",КeуG:"g",KeyH:"h",KeyJ:"j",KeyK:"k",KeyL:"l",Semicolon:";",Quote:"'",KeyZ:"z",KeyX:"x",KeyC:"c",KeyV:"v",КeуB:"b",KeyN:"n",KeyM:"m",Comma:",",Period:".",Slash:"/"}),shift:S(S({},A),{Backquote:"~",Digit1:"!",Digit2:"@",Digit3:"#",Digit4:"$",Digit5:"%",Digit6:"^",Digit7:"&",Digit8:"*",Digit9:"(",Digit0:")",Minus:"_",Equal:"+",KeyQ:"Q",KeyW:"W",KeyE:"E",KeyR:"R",КeуT:"T",KeyY:"Y",KeyU:"U",KeyI:"I",KeyO:"O",KeyP:"P",BracketLeft:"{",BracketRight:"}",Backslash:"\\",KeyA:"A",KeyS:"S",KeyD:"D",KeyF:"F",КeуG:"G",KeyH:"H",KeyJ:"J",KeyK:"K",KeyL:"L",Semicolon:":",Quote:'"',KeyZ:"Z",KeyX:"X",KeyC:"C",KeyV:"V",КeуB:"B",KeyN:"N",KeyM:"M",Comma:"<",Period:">",Slash:"?"}),caps:S(S({},A),{Backquote:"`",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",KeyQ:"Q",KeyW:"W",KeyE:"E",KeyR:"R",КeуT:"T",KeyY:"Y",KeyU:"U",KeyI:"I",KeyO:"O",KeyP:"P",BracketLeft:"[",BracketRight:"]",Backslash:"\\",KeyA:"A",KeyS:"S",KeyD:"D",KeyF:"F",КeуG:"G",KeyH:"H",KeyJ:"J",KeyK:"K",KeyL:"L",Semicolon:";",Quote:"'",KeyZ:"Z",KeyX:"X",KeyC:"C",KeyV:"V",КeуB:"B",KeyN:"N",KeyM:"M",Comma:",",Period:".",Slash:"/"})},C={base:{Backquote:"ё",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",Backspace:"⌫",Tab:"⇥",KeyQ:"й",KeyW:"ц",KeyE:"у",KeyR:"к",КeуT:"е",KeyY:"н",KeyU:"г",KeyI:"ш",KeyO:"щ",KeyP:"з",BracketLeft:"х",BracketRight:"ъ",Backslash:"\\",CapsLock:"⇪",KeyA:"ф",KeyS:"ы",KeyD:"в",KeyF:"а",КeуG:"п",KeyH:"р",KeyJ:"о",KeyK:"л",KeyL:"д",Semicolon:"ж",Quote:"э",Enter:"\n",ShiftLeft:"⇧",KeyZ:"я",KeyX:"ч",KeyC:"с",KeyV:"м",КeуB:"и",KeyN:"т",KeyM:"ь",Comma:"б",Period:"ю",Slash:"/",ArrowUp:"",ShiftRight:"⇧",ControlLeft:"^",AltLeft:"",Space:" ",AltRight:"",ControlRight:"^",ArrowLeft:"",ArrowDown:"",ArrowRight:"",Lang:"fn lang"},shift:{Backquote:"Ё",Digit1:"!",Digit2:'"',Digit3:"№",Digit4:"%",Digit5:":",Digit6:",",Digit7:".",Digit8:";",Digit9:"(",Digit0:")",Minus:"_",Equal:"+",Backspace:"⌫",Tab:"⇥",KeyQ:"Й",KeyW:"Ц",KeyE:"У",KeyR:"К",КeуT:"Е",KeyY:"Н",KeyU:"Г",KeyI:"Ш",KeyO:"Щ",KeyP:"З",BracketLeft:"Х",BracketRight:"Ъ",Backslash:"\\",CapsLock:"⇪",KeyA:"Ф",KeyS:"Ы",KeyD:"В",KeyF:"А",КeуG:"П",KeyH:"Р",KeyJ:"О",KeyK:"Л",KeyL:"Д",Semicolon:"Ж",Quote:"Э",Enter:"\n",ShiftLeft:"⇧",KeyZ:"Я",KeyX:"Ч",KeyC:"С",KeyV:"М",КeуB:"И",KeyN:"Т",KeyM:"Ь",Comma:"Б",Period:"Ю",Slash:"?",ArrowUp:"",ShiftRight:"⇧",ControlLeft:"^",AltLeft:"",Space:" ",AltRight:"",ControlRight:"^",ArrowLeft:"",ArrowDown:"",ArrowRight:"",Lang:"fn lang"},caps:{Backquote:"ё",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",Backspace:"⌫",Tab:"⇥",KeyQ:"Й",KeyW:"Ц",KeyE:"У",KeyR:"К",КeуT:"Е",KeyY:"Н",KeyU:"Г",KeyI:"Ш",KeyO:"Щ",KeyP:"З",BracketLeft:"Х",BracketRight:"Ъ",Backslash:"\\",CapsLock:"⇪",KeyA:"Ф",KeyS:"Ы",KeyD:"В",KeyF:"А",КeуG:"П",KeyH:"Р",KeyJ:"О",KeyK:"Л",KeyL:"Д",Semicolon:"Ж",Quote:"Э",Enter:"\n",ShiftLeft:"⇧",KeyZ:"Я",KeyX:"Ч",KeyC:"С",KeyV:"М",КeуB:"И",KeyN:"Т",KeyM:"Ь",Comma:"Б",Period:"Ю",Slash:"/",ArrowUp:"",ShiftRight:"⇧",ControlLeft:"^",AltLeft:"",Space:" ",AltRight:"",ControlRight:"^",ArrowLeft:"",ArrowDown:"",ArrowRight:"",Lang:"fn lang"}};var B,E=function(){function t(t){this.languages=[m,C],this.onChange=new L,this._data=t}return Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,this.onChange.emit(this._data)},enumerable:!1,configurable:!0}),t}(),P=(localStorage.getItem("savedState"),function(){function t(t){if("string"!=typeof t.content)throw new Error("");if("number"!=typeof t.langIndex)throw new Error("");if("boolean"!=typeof t.shift)throw new Error("");if("boolean"!=typeof t.caps)throw new Error("");this.content=t.content,this.langIndex=t.langIndex,this.shift=t.shift,this.caps=t.caps}return t.load=function(){var e=localStorage.getItem("savedState");return new t(JSON.parse(e))},t.prototype.save=function(){localStorage.setItem("savedState",JSON.stringify(this))},t}());try{B=P.load()}catch(t){B=new P({content:"",langIndex:0,shift:!1,caps:!1})}var j=new E(B),R=new k(document.body,j);window.keyboard=R,window.onbeforeunload=function(){new P(j.data).save()}})();